(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[11],{1492:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[gameMode]/[environmentMode]",function(){return a(765)}])},765:function(e,t,a){"use strict";a.r(t),a.d(t,{__N_SSG:function(){return tn},default:function(){return to}});var s,n,o,r,i,l,c,h,p,d,u,m,x,E,g,y,C,I,j,O,f,A,M,S,N,P,T,L,w,b,R,v=a(5893),_=a(7294);function D(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}function B(e,t){for(let a of e)for(let e of t)if(D(a,e))return!0;return!1}function U(e,t){let a=(e,t)=>({x:e.x+t.x,y:e.y+t.y,z:e.z+t.z});return Array.isArray(e)?e.map(e=>a(e,t)):a(e,t)}(s=g||(g={})).MINECRAFT="MINECRAFT",s.COCOBOTS="COCOBOTS";var H=a(9477);(n=y||(y={})).RED="RED",n.BLUE="BLUE",n.GREEN="GREEN",n.ORANGE="ORANGE",n.PURPLE="PURPLE",n.YELLOW="YELLOW",n.WHITE="WHITE",n.BLACK="BLACK",n.BROWN="BROWN",n.MAGENTA="MAGENTA",n.GREY="GREY";let z={[y.RED]:{hex:"#ff0000",id:y.RED},[y.BLUE]:{hex:"#1b4ccd",id:y.BLUE},[y.GREEN]:{hex:"#008000",id:y.GREEN},[y.ORANGE]:{hex:"#ff6600",id:y.ORANGE},[y.PURPLE]:{hex:"#ac00e6",id:y.PURPLE},[y.YELLOW]:{hex:"#ffa500",id:y.YELLOW},[y.WHITE]:{hex:"#ffffff",id:y.WHITE},[y.BLACK]:{hex:"#000000",id:y.BLACK},[y.BROWN]:{hex:"#553B32",id:y.BROWN},[y.MAGENTA]:{hex:"#e60088",id:y.MAGENTA},[y.GREY]:{hex:"#636363",id:y.GREY}};var G=a(463),F=a(398),k=a(4078);(o=C||(C={})).CELL_BOARD="CELL_BOARD",o.SHAPE="SHAPE",o.SHAPE_FACE="SHAPE_FACE",o.GROUP="GROUP",o.NON_CLICKABLE_FACE="NON_CLICKABLE_FACE",o.SCENE="SCENE",(r=I||(I={})).FRONT="FRONT",r.BACK="BACK",r.TOP="TOP",r.BOTTOM="BOTTOM",r.LEFT="LEFT",r.RIGHT="RIGHT";let W={[I.FRONT]:{translation:new H.Vector3(0,0,.5),rotation:new H.Euler(0,0,0)},[I.BACK]:{translation:new H.Vector3(0,0,-.5),rotation:new H.Euler(0,Math.PI,0)},[I.TOP]:{translation:new H.Vector3(0,.5,0),rotation:new H.Euler(-Math.PI/2,0,0)},[I.BOTTOM]:{translation:new H.Vector3(0,-.5,0),rotation:new H.Euler(Math.PI/2,0,0)},[I.LEFT]:{translation:new H.Vector3(.5,0,0),rotation:new H.Euler(0,Math.PI/2,0)},[I.RIGHT]:{translation:new H.Vector3(-.5,0,0),rotation:new H.Euler(0,-Math.PI/2,0)}},V=e=>{let t=W[e.facingDirection];return(0,v.jsxs)("mesh",{position:t.translation,rotation:t.rotation,userData:{type:C.SHAPE_FACE,faceDirection:e.facingDirection},children:[(0,v.jsx)("planeGeometry",{attach:"geometry",args:[1,1]}),1===e.opacity&&(0,v.jsx)(k.w,{linewidth:1,threshold:15,color:e.color}),(0,v.jsx)("meshStandardMaterial",{attach:"material",color:e.color,transparent:1!==e.opacity,opacity:e.opacity})]})};var $=a(5609);(i=j||(j={}))[i.CUBE=0]="CUBE",i[i.SCREW=1]="SCREW",i[i.NUT=2]="NUT",i[i.WASHER=3]="WASHER",i[i.HORIZONTAL_BRIDGE=4]="HORIZONTAL_BRIDGE",i[i.VERTICAL_BRIDGE=5]="VERTICAL_BRIDGE",i[i.HORIZONTAL_BRIDGE_COMPONENT=6]="HORIZONTAL_BRIDGE_COMPONENT",i[i.VERTICAL_BRIDGE_COMPONENT=7]="VERTICAL_BRIDGE_COMPONENT",i[i.HBRIDGE=8]="HBRIDGE",i[i.VBRIDGE=9]="VBRIDGE",i[i.BOLT=10]="BOLT",i[i.GASKET=11]="GASKET",i[i.HEX_NUT=12]="HEX_NUT",i[i.SQUARE_NUT=13]="SQUARE_NUT",i[i.HOUSE=14]="HOUSE",i[i.CAR=15]="CAR";var K=a(7632);class Y{constructor(e,t,a,s){this.nbObjects=()=>{let e=0;for(let t of this.shapes)t instanceof Y?e+=t.nbObjects():e++;return e},this.objectExists=(e,t,a)=>{for(let s of this.shapes)if(s instanceof Y){if(s.objectExists(e-this.startingPoint.x,t-this.startingPoint.y,a-this.startingPoint.z))return!0}else if(e===s.position.x+this.startingPoint.x&&t===s.position.y+this.startingPoint.y&&a===s.position.z+this.startingPoint.z)return!0;return!1},this.getPositions=()=>this.shapes.flatMap(e=>e instanceof Y?e.getPositions():U(ea[e.shape],e.position)),this.getObjectAtPosition=(e,t,a)=>{for(let s of this.shapes)if(s instanceof Y){let n=s.getObjectAtPosition(e-this.startingPoint.x,t-this.startingPoint.y,a-this.startingPoint.z);if(n)return n}else if(e===s.position.x+this.startingPoint.x&&t===s.position.y+this.startingPoint.y&&a===s.position.z+this.startingPoint.z)return s},this.startingPoint=e,this.shapes=t.map(e=>({...e,breakable:!!s})),this.uuid=(0,K.Z)(),this.pending=a,this.breakable=!!s}}let Z=e=>{let{shapeGroup:t}=e;return(0,v.jsx)("mesh",{userData:{type:C.GROUP,position:t.startingPoint,pending:t.pending},children:t.shapes.map((e,a)=>e instanceof Y?(0,v.jsx)(Z,{shapeGroup:{...e,breakable:t.breakable}},`group-${a}`):(0,v.jsx)(en,{...e,breakable:t.breakable},`shape-${a}`))})},X=e=>{let{color:t,pending:a,position:s,breakable:n}=e,o=new Y(s,[[0,0,0],[1,0,0]].map(e=>{let[s,o,r]=e;return{color:t,pending:a,position:{x:s,y:o,z:r},shape:j.HORIZONTAL_BRIDGE_COMPONENT,uuid:(0,K.Z)(),breakable:n}}),a,n);return(0,v.jsx)(Z,{shapeGroup:o})};var J=e=>{let{pending:t,color:a,rotation:s}=e,n=new H.Color(a.hex),o=t?e9:1,r=_.useMemo(()=>{let e=new H.Shape;e.moveTo(-.4,-.5),e.lineTo(.4,-.5),e.lineTo(.4,.5),e.lineTo(-.4,.5),e.closePath();let t=new H.Path;return t.absarc(0,0,.2,0,2*Math.PI,!1),e.holes.push(t),new H.ShapeGeometry(e,64)},[]),i=_.useMemo(()=>new H.PlaneGeometry(.8,1),[]),l=_.useMemo(()=>new H.PlaneGeometry(1,1),[]),c=(0,v.jsx)("meshStandardMaterial",{attach:"material",color:n,side:H.DoubleSide,transparent:1!==o,opacity:o}),h={type:C.NON_CLICKABLE_FACE},p=e=>{let{position:t,rotation:a,geometry:s,userData:n}=e;return(0,v.jsx)("mesh",{position:t,rotation:a,userData:n,geometry:s,children:c})};return(0,v.jsxs)("mesh",{userData:{...h},scale:[1,1,1],rotation:"VERTICAL"===s?[0,0,0]:[0,Math.PI/2,0],children:[(0,v.jsx)(p,{position:[0,.5,0],rotation:[-Math.PI/2,0,0],geometry:r,userData:{...h,type:C.SHAPE_FACE,faceDirection:I.TOP}}),(0,v.jsx)(p,{position:[0,-.5,0],rotation:[Math.PI/2,0,0],geometry:r,userData:{...h}}),(0,v.jsxs)("mesh",{userData:{...h},children:[(0,v.jsx)("tubeGeometry",{args:[new H.LineCurve3(new H.Vector3(0,-.5,0),new H.Vector3(0,.5,0)),64,.2,64,!1]}),1===o&&(0,v.jsx)(k.w,{linewidth:1,color:n.clone().addScalar(.2)}),c]}),[{position:[0,0,.5],rotation:[0,0,0],geometry:i},{position:[0,0,-.5],rotation:[0,Math.PI,0],geometry:i},{position:[-.4,0,0],rotation:[0,-Math.PI/2,0],geometry:l},{position:[.4,0,0],rotation:[0,Math.PI/2,0],geometry:l}].map((e,t)=>(0,v.jsx)(p,{position:e.position,rotation:e.rotation,geometry:e.geometry,userData:{...h}},t))]})};let Q=e=>{let{color:t,pending:a,position:s,breakable:n}=e,o=new Y(s,[{color:t,pending:a,position:{x:0,y:0,z:0},shape:j.VERTICAL_BRIDGE_COMPONENT,uuid:(0,K.Z)()},{color:t,pending:a,position:{x:0,y:0,z:1},shape:j.VERTICAL_BRIDGE_COMPONENT,uuid:(0,K.Z)()}],a,n);return(0,v.jsx)(Z,{shapeGroup:o})};var q=a(9131),ee=a(1163);let et={[j.CUBE]:e=>{let{pending:t,color:a}=e,s=new H.Color(a.hex);return(0,v.jsx)(v.Fragment,{children:Object.entries(I).map(e=>{let[a,n]=e;return(0,v.jsx)(V,{color:s,opacity:t?e9:1,facingDirection:n},a)})})},[j.SCREW]:function(e){let{pending:t,position:a,color:s}=e,n=new H.Color(s.hex),o=t?e9:1,r=(0,v.jsx)("meshStandardMaterial",{attach:"material",color:n,side:H.FrontSide,transparent:1!==o,opacity:o}),i=(0,_.useMemo)(()=>{let e=new H.Mesh(new H.SphereGeometry(.5,32,16,0,2*Math.PI,0,Math.PI/2)),t=new H.BoxGeometry(.1,.5,.2);t.translate(0,0,-.4),t.rotateX(Math.PI/2);let a=new H.Mesh(t),s=new H.BoxGeometry(.5,.2,.1);s.translate(0,.4,0);let n=new H.Mesh(s),o=$.y.fromMesh(e),r=$.y.fromMesh(a),i=$.y.fromMesh(n),l=o.subtract(r).subtract(i);return $.y.toMesh(l,e.matrixWorld).geometry},[]),l=(0,_.useMemo)(()=>new H.CircleGeometry(.5,32),[]);return(0,v.jsxs)("mesh",{userData:{type:C.NON_CLICKABLE_FACE},scale:[1,2,1],children:[(0,v.jsx)("mesh",{position:[0,-.25,0],userData:{type:C.NON_CLICKABLE_FACE,position:a},geometry:i,children:r}),(0,v.jsx)("mesh",{position:[0,-.25,0],rotation:[Math.PI/2,0,0],userData:{type:C.SHAPE_FACE,faceDirection:I.BOTTOM},geometry:l,children:r})]})},[j.NUT]:function(e){let{pending:t,position:a,color:s}=e,n=new H.Color(s.hex),o=t?e9:1,r=_.useMemo(()=>{let e=new H.Shape;for(let t=0;t<8;t++){let a=t/8*Math.PI*2,s=.5*Math.cos(a),n=.5*Math.sin(a);0===t?e.moveTo(s,n):e.lineTo(s,n)}e.closePath();let t=new H.Path;return t.absarc(0,0,.2,0,2*Math.PI,!1),e.holes.push(t),new H.ShapeGeometry(e)},[]),i=(0,v.jsx)("meshStandardMaterial",{attach:"material",color:n,side:H.DoubleSide,transparent:1!==o,opacity:o});return(0,v.jsxs)("mesh",{userData:{type:C.NON_CLICKABLE_FACE,position:a,pending:t},scale:[1,1,1],rotation:[0,-Math.PI/2,0],children:[(0,v.jsx)("mesh",{position:[0,.5,0],rotation:[-Math.PI/2,0,-Math.PI/2],userData:{type:C.SHAPE_FACE,faceDirection:I.TOP},geometry:r,children:i}),(0,v.jsx)("mesh",{position:[0,-.5,0],rotation:[Math.PI/2,0,Math.PI/2],userData:{type:C.SHAPE_FACE,faceDirection:I.BOTTOM},geometry:r,children:i}),(0,v.jsxs)("mesh",{userData:{type:C.NON_CLICKABLE_FACE,position:a,pending:t},children:[(0,v.jsx)("tubeGeometry",{args:[new H.LineCurve3(new H.Vector3(0,-.5,0),new H.Vector3(0,.5,0)),1,.5,8,!1]}),1===o&&(0,v.jsx)(k.w,{linewidth:1,color:n.clone().addScalar(.2)}),i]}),(0,v.jsxs)("mesh",{userData:{type:C.NON_CLICKABLE_FACE,position:a,pending:t},children:[(0,v.jsx)("tubeGeometry",{args:[new H.LineCurve3(new H.Vector3(0,-.5,0),new H.Vector3(0,.5,0)),1,.2,20,!1]}),i]})]})},[j.HORIZONTAL_BRIDGE]:X,[j.VERTICAL_BRIDGE]:Q,[j.HBRIDGE]:X,[j.VBRIDGE]:Q,[j.WASHER]:function(e){let{pending:t,position:a,color:s}=e,n=new H.Color(s.hex),o=t?e9:1,r=_.useMemo(()=>{let e=new H.Shape;for(let t=0;t<32;t++){let a=t/32*Math.PI*2,s=.5*Math.cos(a),n=.5*Math.sin(a);0===t?e.moveTo(s,n):e.lineTo(s,n)}e.closePath();let t=new H.Path;return t.absarc(0,0,.2,0,2*Math.PI,!1),e.holes.push(t),new H.ShapeGeometry(e)},[]),i=(0,v.jsx)("meshStandardMaterial",{attach:"material",color:n,side:H.DoubleSide,transparent:1!==o,opacity:o});return(0,v.jsxs)("mesh",{userData:{type:C.NON_CLICKABLE_FACE,position:a,pending:t},scale:[1,1,1],rotation:[0,-Math.PI/2,0],children:[(0,v.jsx)("mesh",{position:[0,.5,0],rotation:[-Math.PI/2,0,-Math.PI/2],userData:{type:C.SHAPE_FACE,faceDirection:I.TOP},geometry:r,children:i}),(0,v.jsx)("mesh",{position:[0,-.5,0],rotation:[Math.PI/2,0,Math.PI/2],userData:{type:C.SHAPE_FACE,faceDirection:I.BOTTOM},geometry:r,children:i}),(0,v.jsxs)("mesh",{userData:{type:C.NON_CLICKABLE_FACE,position:a,pending:t},children:[(0,v.jsx)("tubeGeometry",{args:[new H.LineCurve3(new H.Vector3(0,-.5,0),new H.Vector3(0,.5,0)),1,.5,32,!1]}),1===o&&(0,v.jsx)(k.w,{linewidth:1,color:n.clone().addScalar(.2)}),i]}),(0,v.jsxs)("mesh",{userData:{type:C.NON_CLICKABLE_FACE,position:a,pending:t},children:[(0,v.jsx)("tubeGeometry",{args:[new H.LineCurve3(new H.Vector3(0,-.5,0),new H.Vector3(0,.5,0)),1,.2,20,!1]}),i]})]})},[j.HORIZONTAL_BRIDGE_COMPONENT]:e=>(0,v.jsx)(J,{...e,rotation:"HORIZONTAL"}),[j.VERTICAL_BRIDGE_COMPONENT]:e=>(0,v.jsx)(J,{...e,rotation:"VERTICAL"}),[j.BOLT]:function(e){let{pending:t,position:a,color:s}=e,n=new H.Color(s.hex),o=t?e9:1,r=_.useMemo(()=>{let e=new H.Shape;for(let t=0;t<6;t++){let a=t/6*Math.PI*2,s=.5*Math.cos(a),n=.5*Math.sin(a);0===t?e.moveTo(s,n):e.lineTo(s,n)}return e.closePath(),new H.ShapeGeometry(e)},[]),i=(0,v.jsx)("meshStandardMaterial",{attach:"material",color:n,side:H.DoubleSide,transparent:1!==o,opacity:o});return(0,v.jsxs)("mesh",{userData:{type:C.NON_CLICKABLE_FACE,position:a,pending:t},scale:[1,1,1],rotation:[0,-Math.PI/2,0],children:[(0,v.jsx)("mesh",{position:[0,.5,0],rotation:[-Math.PI/2,0,-Math.PI/2],userData:{type:C.NON_CLICKABLE_FACE,position:a},geometry:r,children:i}),(0,v.jsx)("mesh",{position:[0,-.5,0],rotation:[Math.PI/2,0,Math.PI/2],userData:{type:C.SHAPE_FACE,faceDirection:I.BOTTOM},geometry:r,children:i}),(0,v.jsxs)("mesh",{userData:{type:C.NON_CLICKABLE_FACE,position:a,pending:t},children:[(0,v.jsx)("tubeGeometry",{args:[new H.LineCurve3(new H.Vector3(0,-.5,0),new H.Vector3(0,.5,0)),1,.5,6,!1]}),1===o&&(0,v.jsx)(k.w,{linewidth:1,color:n.clone().addScalar(.2)}),i]})]})},[j.GASKET]:function(e){let{pending:t,color:a}=e,s=new H.Color(a.hex),n=t?e9:1;return(0,v.jsxs)("mesh",{userData:{type:C.SHAPE_FACE,faceDirection:I.TOP},scale:[1,1,5],rotation:[-Math.PI/2,0,0],children:[(0,v.jsx)("torusGeometry",{args:[.4,.1,8,16]}),(0,v.jsx)("meshStandardMaterial",{color:s,side:H.DoubleSide,transparent:1!==n,opacity:n})]})},[j.HEX_NUT]:function(e){let{pending:t,position:a,color:s}=e,n=new H.Color(s.hex),o=t?e9:1,r=_.useMemo(()=>{let e=new H.Shape;for(let t=0;t<6;t++){let a=t/6*Math.PI*2,s=.5*Math.cos(a),n=.5*Math.sin(a);0===t?e.moveTo(s,n):e.lineTo(s,n)}e.closePath();let t=new H.Path;return t.absarc(0,0,.2,0,2*Math.PI,!1),e.holes.push(t),new H.ShapeGeometry(e)},[]),i=(0,v.jsx)("meshStandardMaterial",{attach:"material",color:n,side:H.DoubleSide,transparent:1!==o,opacity:o});return(0,v.jsxs)("mesh",{userData:{type:C.NON_CLICKABLE_FACE,position:a,pending:t},scale:[1,1,1],rotation:[0,-Math.PI/2,0],children:[(0,v.jsx)("mesh",{position:[0,.5,0],rotation:[-Math.PI/2,0,-Math.PI/2],userData:{type:C.SHAPE_FACE,faceDirection:I.TOP},geometry:r,children:i}),(0,v.jsx)("mesh",{position:[0,-.5,0],rotation:[Math.PI/2,0,Math.PI/2],userData:{type:C.SHAPE_FACE,faceDirection:I.BOTTOM},geometry:r,children:i}),(0,v.jsxs)("mesh",{userData:{type:C.NON_CLICKABLE_FACE,position:a,pending:t},children:[(0,v.jsx)("tubeGeometry",{args:[new H.LineCurve3(new H.Vector3(0,-.5,0),new H.Vector3(0,.5,0)),1,.5,6,!1]}),1===o&&(0,v.jsx)(k.w,{linewidth:1,color:n.clone().addScalar(.2)}),i]}),(0,v.jsxs)("mesh",{userData:{type:C.NON_CLICKABLE_FACE,position:a,pending:t},children:[(0,v.jsx)("tubeGeometry",{args:[new H.LineCurve3(new H.Vector3(0,-.5,0),new H.Vector3(0,.5,0)),1,.2,20,!1]}),i]})]})},[j.SQUARE_NUT]:function(e){let{pending:t,position:a,color:s}=e,n=new H.Color(s.hex),o=t?e9:1,r=_.useMemo(()=>{let e=new H.Shape;for(let t=0;t<4;t++){let a=t/4*Math.PI*2,s=.5*Math.cos(a),n=.5*Math.sin(a);0===t?e.moveTo(s,n):e.lineTo(s,n)}e.closePath();let t=new H.Path;return t.absarc(0,0,.2,0,2*Math.PI,!1),e.holes.push(t),new H.ShapeGeometry(e)},[]),i=(0,v.jsx)("meshStandardMaterial",{attach:"material",color:n,side:H.DoubleSide,transparent:1!==o,opacity:o});return(0,v.jsxs)("mesh",{userData:{type:C.NON_CLICKABLE_FACE,position:a,pending:t},scale:[1,1,1],rotation:[0,-Math.PI/2,0],children:[(0,v.jsx)("mesh",{position:[0,.5,0],rotation:[-Math.PI/2,0,-Math.PI/2],userData:{type:C.SHAPE_FACE,faceDirection:I.TOP},geometry:r,children:i}),(0,v.jsx)("mesh",{position:[0,-.5,0],rotation:[Math.PI/2,0,Math.PI/2],userData:{type:C.SHAPE_FACE,faceDirection:I.BOTTOM},geometry:r,children:i}),(0,v.jsxs)("mesh",{userData:{type:C.NON_CLICKABLE_FACE,position:a,pending:t},children:[(0,v.jsx)("tubeGeometry",{args:[new H.LineCurve3(new H.Vector3(0,-.5,0),new H.Vector3(0,.5,0)),1,.5,4,!1]}),1===o&&(0,v.jsx)(k.w,{linewidth:1,color:n.clone().addScalar(.2)}),i]}),(0,v.jsxs)("mesh",{userData:{type:C.NON_CLICKABLE_FACE,position:a,pending:t},children:[(0,v.jsx)("tubeGeometry",{args:[new H.LineCurve3(new H.Vector3(0,-.5,0),new H.Vector3(0,.5,0)),1,.2,20,!1]}),i]})]})},[j.HOUSE]:function(e){let{pending:t,position:a,color:s}=e,n=(0,_.useMemo)(()=>new H.Color(s.hex),[s.hex]),o=t?e9:1,r=(0,ee.useRouter)(),{scene:i}=(0,q.L)(`${r.basePath}/assets/gltf/house.gltf`),l=(0,_.useMemo)(()=>{let e=i.clone(!0);return e.traverse(e=>{e.isMesh&&(e.material=new H.MeshStandardMaterial({color:n,side:H.DoubleSide,transparent:o<1,opacity:o}),e.castShadow=!0,e.receiveShadow=!0)}),e},[i,n,o]);return(0,v.jsx)("mesh",{userData:{type:C.NON_CLICKABLE_FACE,position:a,pending:t},scale:[.045,.1,.04],position:[3,-1.4,.6],children:(0,v.jsx)("primitive",{object:l})})},[j.CAR]:function(e){let{pending:t,position:a,color:s}=e,n=(0,_.useMemo)(()=>new H.Color(s.hex),[s.hex]),o=t?e9:1,r=(0,ee.useRouter)(),{scene:i}=(0,q.L)(`${r.basePath}/assets/gltf/car.gltf`),l=(0,_.useMemo)(()=>{let e=i.clone(!0);return e.traverse(e=>{e.isMesh&&(e.material=new H.MeshStandardMaterial({color:n,side:H.DoubleSide,transparent:o<1,opacity:o}),e.castShadow=!0,e.receiveShadow=!0)}),e},[i,n,o]);return(0,v.jsx)("mesh",{userData:{type:C.NON_CLICKABLE_FACE,position:a,pending:t},scale:[.4,1,.4],position:[.5,-.5,0],rotation:[0,Math.PI/2,0],children:(0,v.jsx)("primitive",{object:l})})}},ea={[j.CUBE]:[{x:0,y:0,z:0}],[j.SCREW]:[{x:0,y:0,z:0}],[j.NUT]:[{x:0,y:0,z:0}],[j.HORIZONTAL_BRIDGE]:[{x:0,y:0,z:0},{x:1,y:0,z:0}],[j.VERTICAL_BRIDGE]:[{x:0,y:0,z:0},{x:0,y:0,z:1}],[j.HBRIDGE]:[{x:0,y:0,z:0},{x:1,y:0,z:0}],[j.VBRIDGE]:[{x:0,y:0,z:0},{x:0,y:0,z:1}],[j.WASHER]:[{x:0,y:0,z:0}],[j.HORIZONTAL_BRIDGE_COMPONENT]:[{x:0,y:0,z:0}],[j.VERTICAL_BRIDGE_COMPONENT]:[{x:0,y:0,z:0}],[j.BOLT]:[{x:0,y:0,z:0}],[j.GASKET]:[{x:0,y:0,z:0}],[j.HEX_NUT]:[{x:0,y:0,z:0}],[j.SQUARE_NUT]:[{x:0,y:0,z:0}],[j.HOUSE]:[{x:0,y:0,z:0},{x:-1,y:0,z:0},{x:1,y:0,z:0},{x:-1,y:0,z:-1},{x:0,y:0,z:-1},{x:1,y:0,z:-1}],[j.CAR]:[{x:0,y:0,z:0},{x:1,y:0,z:0}]},es=(e,t,a)=>{let s=e=>[parseInt(e.slice(1,3),16),parseInt(e.slice(3,5),16),parseInt(e.slice(5,7),16)],n=s(e),o=s(t);return"#"+n.map((e,t)=>Math.max(0,Math.min(255,Math.round(e+(o[t]-e)*a/100)))).map(e=>e.toString(16).padStart(2,"0")).join("")},en=e=>{let t=et[e.shape];return(0,v.jsx)("mesh",{userData:{type:C.SHAPE,position:e.position,pending:e.pending,shape:e.shape},position:[e.position.x,e.position.y,e.position.z],children:e.breakable&&(0,v.jsx)(t,{...e,color:e.breakable?{hex:es(e.color.hex,z.WHITE.hex,40),id:z.WHITE.id}:e.color})||(0,v.jsx)(t,{...e})})};(l=O||(O={})).SIMULATION="SIMULATION",l.VISUALIZATION="VISUALIZATION",l.NEBULA="NEBULA",l.DIRECT_INSTRUCTIONS="DIRECT_INSTRUCTIONS",l.MULTIMODAL="MULTIMODAL";var eo=a(2473),er=a(8727),ei=e=>{let{environmentMode:t}=e,a=e0[t],s=[];for(let e=a.x.min;e<=a.x.max;e++)for(let t=a.z.min;t<=a.z.max;t++)s.push({x:e,y:0,z:t});return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(er.EJ,{rotation:[-Math.PI/2,0,0],position:[0,.5,0],limit:s.length,children:[(0,v.jsx)("planeGeometry",{args:[1,1]}),(0,v.jsx)("meshStandardMaterial",{color:[te.r,te.g,te.b]}),s.map((e,t)=>{let{x:a,z:s}=e;return(0,v.jsx)(er.K4,{userData:{type:C.CELL_BOARD,position:{x:a,y:0,z:s}},position:[a,-s,0],children:(0,v.jsxs)("lineSegments",{raycast:()=>null,children:[(0,v.jsx)("edgesGeometry",{attach:"geometry",args:[new H.PlaneGeometry(1,1)]}),(0,v.jsx)("lineBasicMaterial",{color:"black"})]})},t)})]}),(0,v.jsx)(eo.x,{scale:[1,1,1],rotation:[Math.PI/2,Math.PI,0],position:[(a.x.max+a.x.min)/2,.5,a.z.min-2],color:"white",anchorX:"center",anchorY:"middle",children:"N"}),(0,v.jsx)(eo.x,{scale:[1,1,1],rotation:[Math.PI/2,0,0],position:[a.x.max+2,.5,(a.z.max+a.z.min)/2],color:"white",anchorX:"center",anchorY:"middle",children:"E"}),(0,v.jsx)(eo.x,{scale:[1,1,1],rotation:[Math.PI/2,0,Math.PI],position:[a.x.min-2,.5,(a.z.max+a.z.min)/2],color:"white",anchorX:"center",anchorY:"middle",children:"W"}),(0,v.jsx)(eo.x,{scale:[1,1,1],rotation:[Math.PI/2,Math.PI,Math.PI],position:[(a.x.max+a.x.min)/2,.5,a.z.max+2],color:"white",anchorX:"center",anchorY:"middle",children:"S"})]})};(c=f||(f={})).PLACE="PLACE",c.BREAK="REMOVE";let el={[I.FRONT]:{x:0,y:0,z:1},[I.BACK]:{x:0,y:0,z:-1},[I.TOP]:{x:0,y:1,z:0},[I.BOTTOM]:{x:0,y:-1,z:0},[I.LEFT]:{x:1,y:0,z:0},[I.RIGHT]:{x:-1,y:0,z:0}},ec=()=>{let[e,t]=(0,_.useState)([]),[a,s]=(0,_.useState)(),n=e=>{t(t=>[...t,e])};return{objects:e,pending:a,setObjects:t,setPending:s,nbObjects:()=>{let t=0;for(let a of e)a instanceof Y?t+=a.nbObjects():t++;return t},objectExists:(t,a,s)=>{for(let n of e)if(n instanceof Y){if(n.objectExists(t,a,s))return!0}else if(t===n.position.x&&a===n.position.y&&s===n.position.z)return!0;return!1},getObjectAtPosition:(t,a,s)=>{for(let n of e)if(n instanceof Y){let e=n.getObjectAtPosition(t,a,s);if(e)return e}else if(t===n.position.x&&a===n.position.y&&s===n.position.z)return n},addObject:n,removeObject:(e,a,s)=>{t(t=>t.filter(t=>{if(t instanceof Y){if(t.objectExists(e,a,s))return!1}else if(t.position.x===e&&t.position.y===a&&t.position.z===s)return!1;return!0}))},clear:()=>{t([])},confirmPending:e=>{a&&n({...a,pending:!1}),s(e)},setBreaking:e=>{let a=e=>e.breakable?e:{...e,breakable:!0};t(t=>t.map(t=>t instanceof Y&&D(t.startingPoint,e)?a(t):"position"in t&&D(t.position,e)?a(t):t))},removeBreaking:()=>{let e=e=>({...e,breakable:!1});t(t=>t.map(t=>t.breakable?e(t):t))},getPosition:()=>e.flatMap(e=>U(ea[e.shape],e.position))}},eh=(e,t)=>{let[a,s]=(0,_.useState)(e[0]),[n,o]=(0,_.useState)(e),[r,i]=(0,_.useState)(t[0]),[l,c]=(0,_.useState)(t);return{currentColor:a,colors:n,currentShape:r,shapes:l,setCurrentColor:s,setColors:o,setCurrentShape:i,setShapes:c,changeColor:e=>{s(z[e])}}},ep=()=>{let[e,t]=(0,_.useState)([]);return{chatHistory:e,setChatHistory:t,addMessage:e=>{e.content&&t(t=>[...t,e])},clear:()=>{t([])}}};class ed{constructor(){this.gameLog=[{chatHistory:[],shapeInPlace:[],timestamp:new Date}]}getLength(){return this.gameLog.length}addWorldState(e){this.gameLog.push(e)}clear(){this.gameLog=[]}getLastWorldState(){let e=this.gameLog[this.gameLog.length-1];return e?e.timestamp?{timestamp:e.timestamp,chatHistory:[...e.chatHistory],shapeInPlace:[...e.shapeInPlace]}:{chatHistory:[...e.chatHistory],shapeInPlace:[...e.shapeInPlace]}:void 0}getWorldStateById(e){if(e<this.gameLog.length){let t=this.gameLog[e];return t.timestamp?{timestamp:t.timestamp,chatHistory:[...t.chatHistory],shapeInPlace:[...t.shapeInPlace]}:{chatHistory:[...t.chatHistory],shapeInPlace:[...t.shapeInPlace]}}}}let eu=(0,_.createContext)(void 0),em=e=>{let{children:t,initialEnvironmentMode:a,initialGameMode:s}=e,[n,o]=(0,_.useState)(a),[r,i]=(0,_.useState)(s),[l,c]=(0,_.useState)(e4[s]),[h,p]=(0,_.useState)(new ed),[d,u]=(0,_.useState)(e7[a]),m=ec(),x=ep(),E=eh(eQ[a],eq[a]),[g,y]=(0,_.useState)(void 0),C=()=>{c(e4[r]),p(new ed),m.clear(),x.setChatHistory([]),r===O.MULTIMODAL?(E.setCurrentColor(z.GREY),E.setCurrentShape(j.CUBE)):(E.setCurrentColor(eQ[n][0]),E.setCurrentShape(eq[n][0])),E.setColors(eQ[n]),E.setShapes(eq[n]),u(e7[n]),y(void 0)};return(0,_.useEffect)(C,[n,r]),(0,_.useEffect)(()=>{let e=h.getLastWorldState();e?(m.objects.length!==e.shapeInPlace.length||x.chatHistory.length!==e.chatHistory.length)&&(h.addWorldState({timestamp:new Date,chatHistory:[...x.chatHistory],shapeInPlace:[...m.objects]}),p(h)):(0!==m.objects.length||0!==x.chatHistory.length)&&(h.addWorldState({timestamp:new Date,chatHistory:[...x.chatHistory],shapeInPlace:[...m.objects]}),p(h))},[m.objects,x.chatHistory]),(0,v.jsx)(eu.Provider,{value:{environmentMode:{environmentMode:n,setEnvironmentMode:o},gameMode:{gameMode:r,setGameMode:i},action:{action:l,setAction:c},pointer:{pointer:g,setPointer:y},gameLog:{gameLog:h,setGameLog:p},camera:{camera:d,setCamera:u},shapeInPlace:m,inventory:E,chat:x,clear:C},children:t})},ex=()=>{let e=(0,_.useContext)(eu);if(void 0===e)throw Error("useGlobalState must be used within a GlobalStateProvider");return e};function eE(e){if(e.userData.type===C.SHAPE||e.userData.type!==C.NON_CLICKABLE_FACE&&e.userData.type!==C.SHAPE_FACE)return e;{let t=e;for(;t.userData.type!==C.SHAPE;)t.parent&&(t=t.parent);return t}}function eg(e){let t={x:0,y:0,z:0};e.userData.type===C.SHAPE?t=U(t,e.userData.position):e.userData.type===C.GROUP&&(t=U(t,e.userData.position));let a=e.parent;return a.userData.type===C.GROUP?U(t,eg(a)):t}var ey=()=>{let{gameMode:{gameMode:e},environmentMode:{environmentMode:t},pointer:{setPointer:a},shapeInPlace:s,inventory:n,action:o}=ex(),{objects:r,pending:i}=s,[l,c]=(0,_.useState)(null),h=(e,a,o)=>{let r={uuid:(0,K.Z)(),pending:!0,breakable:!1,color:n.currentColor,position:e,shape:a};return e3[t](r,U(ea[r.shape],r.position),s.getPosition(),o)},p=e=>{let t=e.intersections[0].object,a=eE(t);if(t.userData.type===C.SHAPE_FACE){let e=t.userData,o=U(eg(a),el[e.faceDirection]);s.confirmPending(h(o,n.currentShape,!0))}else s.confirmPending();e.stopPropagation()},d=e=>{if(e.intersections[0]){let t=eE(e.intersections[0].object);if(t.userData.type===C.SHAPE){for(;t.parent?.userData.type===C.GROUP;)t=t.parent;let e=eg(t);s.removeObject(e.x,e.y,e.z)}x(e.intersections.slice(1))}e.stopPropagation()},u=(0,_.useRef)([]),m=e=>{if(e[0]){let t=e[0].object;if(t.userData.type===C.CELL_BOARD){let e=t.userData,a=s.pending,o={...e.position,y:e.position.y+1};a&&D(a instanceof Y?a.startingPoint:a.position,o)||s.setPending(h(o,n.currentShape))}else if(t.userData.type===C.SHAPE_FACE){let e=t.userData,a=eE(t);if(!(a?.userData).pending){let t=s.pending,o=U(eg(a),el[e.faceDirection]);t&&B([t instanceof Y?t.startingPoint:t.position],[o])||s.setPending(h(o,n.currentShape))}}else s.setPending(void 0)}},x=e=>{if(console.log("change"),e[0]){let t=eE(e[0].object);if(t.userData.type===C.SHAPE){for(;t.parent?.userData.type===C.GROUP;)t=t.parent;let e=eg(t),n=s.getObjectAtPosition(e.x,e.y,e.z);if(n?.position==e)return;s.removeBreaking(),s.setBreaking(e),a&&a({cartesianCoordinate:e,type:C.SHAPE})}else if(t.userData.type===C.CELL_BOARD){let e=t.userData;a&&a({cartesianCoordinate:e.position,type:C.CELL_BOARD})}}},E=(0,_.useMemo)(()=>r.map(e=>e instanceof Y?(0,v.jsx)(Z,{shapeGroup:{...e}},`${e.uuid}-${e.breakable}-${e.pending}`):(0,v.jsx)(en,{...e},`${e.uuid}-${e.breakable}-${e.pending}`)),[r]),g=(0,_.useMemo)(()=>i&&(e===O.SIMULATION||e===O.MULTIMODAL)&&(i instanceof Y?(0,v.jsx)(Z,{shapeGroup:i},i.uuid):(0,v.jsx)(en,{...i},i.uuid)),[i,e]);return(0,v.jsxs)("mesh",{onPointerDown:e=>c({x:e.clientX,y:e.clientY}),onPointerMove:e=>{let t=e.intersections.filter(e=>{let t=eE(e.object);return t.userData.type!==C.SHAPE||!t.userData.pending});console.log(t[0]);let a=t.map(e=>e.object.uuid).sort();JSON.stringify(a)!==JSON.stringify(u.current)&&(u.current=a,o.action===f.PLACE?m(t):x(t),e.stopPropagation())},onPointerOut:e=>{0===e.intersections.length&&(s.setPending(void 0),s.removeBreaking(),a&&a(void 0))},onPointerUp:t=>{if(l&&(e===O.SIMULATION||e===O.MULTIMODAL)){let e=Math.abs(t.clientX-l.x),a=Math.abs(t.clientY-l.y);e<5&&a<5&&(o.action===f.PLACE?s.pending&&p(t):o.action===f.BREAK&&d(t))}c(null)},scale:[eJ[t].x,eJ[t].y,eJ[t].z],userData:{type:C.SCENE},children:[(0,v.jsx)(ei,{environmentMode:t},t),E,g]})};(h=A||(A={})).FREE="Free camera",h.SIDE_VIEW="Side view",h.UPPER_VIEW="Upper view",h.RANDOM="Random",h.RANDOM2="Random2";let eC=e=>({orthographic:!1,polarAngle:{max:Math.PI,min:0},cameraSettings:{fov:75,aspect:window.innerWidth/window.innerHeight,near:.1,far:1e3,position:e}}),eI={[A.FREE]:eC([0,5,10]),[A.SIDE_VIEW]:{orthographic:!0,polarAngle:{max:Math.PI/2,min:Math.PI/2},cameraSettings:{zoom:50,position:[100,5,10]}},[A.UPPER_VIEW]:{orthographic:!0,polarAngle:{max:0,min:0},cameraSettings:{zoom:50,position:[0,5,10]},azimuthAngle:{max:0,min:0}},[A.RANDOM]:()=>eC([30*Math.random()-15,15*Math.random()+2,30*Math.random()-15]),[A.RANDOM2]:()=>eC([30*Math.random()-15,15*Math.random()+2,30*Math.random()-15])},ej=()=>{let{environmentMode:{environmentMode:e}}=ex(),t=e0[e];return(0,v.jsx)("mesh",{position:[-(t.x.max+t.x.min)/2,1,-(t.z.max+t.z.min)/2],children:(0,v.jsx)(ey,{})})};var eO=()=>{let e=new H.Color(1710878),{camera:t}=ex().camera,a="function"==typeof eI[t]?eI[t]():eI[t];return a&&"orthographic"in a?(0,v.jsxs)(G.Xz,{gl:{preserveDrawingBuffer:!0},frameloop:"demand",orthographic:a.orthographic,camera:a.cameraSettings,children:[(0,v.jsx)(ej,{}),(0,v.jsx)(F.z,{enablePan:!1,minPolarAngle:a.polarAngle.min,maxPolarAngle:a.polarAngle.max,minAzimuthAngle:a.azimuthAngle?.min,maxAzimuthAngle:a.azimuthAngle?.max}),(0,v.jsx)("fog",{attach:"fog",args:["white",20,1e3]}),(0,v.jsx)("ambientLight",{intensity:1}),(0,v.jsx)("pointLight",{color:"white",position:[3,10,3],intensity:200}),(0,v.jsx)("color",{attach:"background",args:[e.r,e.g,e.b]})]},t):null},ef=e=>{let{children:t}=e;return(0,v.jsx)("div",{id:"side",children:t})},eA=()=>{let{inventory:{currentColor:e,colors:t,changeColor:a},environmentMode:{environmentMode:s}}=ex(),n=s===g.COCOBOTS?5:3,o=[];for(let e=0;e<t.length;e+=n)o.push(t.slice(e,e+n));return(0,v.jsxs)("div",{id:"colorPicker",className:"module",children:[(0,v.jsx)("h3",{children:"Color Picker"}),(0,v.jsx)("div",{id:"colorList",children:o.map((t,s)=>(0,v.jsx)("div",{children:t.map(t=>(0,v.jsx)("div",{className:`realisticButton color${e.id===t.id?" selected":""}`,style:{backgroundColor:t.hex},onMouseDown:()=>a(t.id),children:(0,v.jsx)("span",{children:t.id[0]+t.id.slice(1).toLowerCase()})},t.id))},s))})]})},eM=()=>{let{action:e,setAction:t}=ex().action;return(0,v.jsxs)("div",{id:"actionSelector",className:"module",children:[(0,v.jsx)("h3",{children:"Action:"}),(0,v.jsx)("div",{className:"buttonsWrapper",children:Object.values(f).map(a=>(0,v.jsx)("button",{className:`realisticButton ${a}${e===a?" selected":""}`,onMouseDown:()=>t(a),children:a[0]+a.slice(1).toLowerCase()},a))})]})},eS=()=>{let{inventory:{currentColor:e,currentShape:t,shapes:a,setCurrentShape:s}}=ex(),n=(0,ee.useRouter)(),o=[];for(let e=0;e<a.length;e+=3)o.push(a.slice(e,e+3));return a.length>1&&(0,v.jsxs)("div",{id:"shapePicker",className:"module",children:[(0,v.jsx)("h3",{children:"Shape Picker"}),(0,v.jsx)("div",{id:"colorList",children:o.map((a,o)=>(0,v.jsx)("div",{children:a.map(a=>{let o=`${j[a]}-${e.id}`;return(0,v.jsxs)("div",{className:`color${t===a?" selected":""}`,onClick:()=>s(a),children:[(0,v.jsx)("img",{src:`${n.basePath}/assets/icons/shapes/${o}.png`,alt:o}),(0,v.jsx)("span",{children:j[a][0]+j[a].slice(1).toLowerCase().replace("_"," ")})]},a)})},o))})]})||(0,v.jsx)(v.Fragment,{})},eN=a(1375);(p=M||(M={})).SYSTEM="SYSTEM",p.ARCHITECT="ARCHITECT",p.BUILDER="BUILDER",p.NEBULA="NEBULA",p.UNKNOWN="UNKNOWN";let eP={[M.ARCHITECT]:"/assets/icons/Users/architect.png",[M.BUILDER]:"/assets/icons/Users/builder.png",[M.SYSTEM]:"/assets/icons/Users/settings.png",[M.NEBULA]:"/assets/icons/Users/robot.png",[M.UNKNOWN]:"/assets/icons/Users/unknown.png"},eT={[g.COCOBOTS]:"/assets/icons/environmentMode/cocobots.png",[g.MINECRAFT]:"/assets/icons/environmentMode/minecraft.png"};function eL(){return(eL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e}).apply(null,arguments)}(d=S||(S={})).PLACEMENT="Shapes placed.",d.WAIT="Please Wait",d.WRONG_FILE_EXTENSION="The extension file is incorrect.",d.NOT_ENOUGH_PLAYERS="Not enough players showed up.";var ew=e=>_.createElement("svg",eL({xmlns:"http://www.w3.org/2000/svg",width:800,height:800,fill:"none",viewBox:"0 0 24 24"},e),N||(N=_.createElement("path",{fill:"#1C274C",d:"M12.554 16.506a.75.75 0 0 1-1.107 0l-4-4.375a.75.75 0 0 1 1.107-1.012l2.696 2.95V3a.75.75 0 0 1 1.5 0v11.068l2.697-2.95a.75.75 0 1 1 1.107 1.013z"})),P||(P=_.createElement("path",{fill:"#1C274C",d:"M3.75 15a.75.75 0 0 0-1.5 0v.055c0 1.367 0 2.47.117 3.337.12.9.38 1.658.981 2.26.602.602 1.36.86 2.26.982.867.116 1.97.116 3.337.116h6.11c1.367 0 2.47 0 3.337-.116.9-.122 1.658-.38 2.26-.982s.86-1.36.982-2.26c.116-.867.116-1.97.116-3.337V15a.75.75 0 0 0-1.5 0c0 1.435-.002 2.436-.103 3.192-.099.734-.28 1.122-.556 1.399-.277.277-.665.457-1.4.556-.755.101-1.756.103-3.191.103H9c-1.435 0-2.437-.002-3.192-.103-.734-.099-1.122-.28-1.399-.556-.277-.277-.457-.665-.556-1.4-.101-.755-.103-1.756-.103-3.191"}))),eb=e=>{let{availableUsers:t}=e,a=(0,_.useRef)(null),s=(0,ee.useRouter)(),{chat:n,gameLog:{gameLog:o},gameMode:{gameMode:r},environmentMode:{environmentMode:i},shapeInPlace:l}=ex();(0,_.useEffect)(()=>{a.current&&(a.current.scrollTop=a.current.scrollHeight)},[n.chatHistory]);let[c,h]=(0,_.useState)(M.ARCHITECT),[p,d]=(0,_.useState)(!1),[u,m]=(0,_.useState)(!1);return(0,v.jsxs)("div",{id:"chat",className:"module",children:[(0,v.jsx)("h3",{children:"Chat"}),(0,v.jsx)("hr",{}),(0,v.jsx)("div",{className:"historyMessages",ref:a,children:n.chatHistory.map((e,t)=>(0,v.jsxs)("div",{children:[(0===t||e.user!==n.chatHistory[t-1].user)&&(0,v.jsxs)("div",{children:[(0,v.jsx)("img",{className:"userIcon",src:`${s.basePath}${eP[Object.keys(M).includes(e.user.toUpperCase())?e.user.toUpperCase():M.UNKNOWN]}`,alt:"userIcon"}),(0,v.jsx)("span",{className:"userName",children:e.user[0]+e.user.slice(1).toLowerCase()},`user-${t}`)]}),(0,v.jsx)("div",{className:`message${e.user===M.SYSTEM?" system":""}`,children:e.content},t)]},t))}),t.length>=1&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("hr",{}),(0,v.jsxs)("div",{className:"buttons",children:[(0,v.jsxs)("div",{className:"mainButtons",children:[(0,v.jsx)("button",{className:1!==t.length?"realisticButton":"alone",onMouseDown:()=>{h(t[(t.findIndex(e=>e===c)+1)%t.length])},children:c}),(0,v.jsx)("input",{type:"text",className:p?"disable":"",disabled:p,placeholder:"writing here...",onKeyDown:e=>{if("Enter"===e.key){let t=e.currentTarget.value;if(n.addMessage({content:t,user:c}),e.currentTarget.value="",r===O.DIRECT_INSTRUCTIONS){if(/^place\(['"].+['"], ['"].+['"], [0-9]+, [0-9]+, [0-9]+\)(\s)?$/gm.test(t)){let e=/\(['"]([^'"]+)['"], ['"]([^'"]+)['"], (\d+), (\d+), (\d+)\)/;t.split("place").slice(1).forEach(t=>{let a=t.match(e);console.log(a),l.addObject({breakable:!1,color:z[a[2].toUpperCase()]||z.WHITE,shape:j[a[1].toUpperCase()]||j.CUBE,pending:!1,position:{x:parseInt(a[3]),y:parseInt(a[5]),z:parseInt(a[4])},uuid:"test"})})}else n.addMessage({user:M.SYSTEM,content:"Not a right placement structure"})}}}})]}),r===O.NEBULA&&(0,v.jsxs)("div",{className:"nebulaWrapperButtons",children:[(0,v.jsx)("button",{className:"realisticButton generate"+(p||0===(n.chatHistory.some(e=>e.user===M.SYSTEM&&e.content===S.PLACEMENT)?n.chatHistory.slice(n.chatHistory.reduceRight((e,t,a)=>-1===e&&t.user===M.SYSTEM&&t.content===S.PLACEMENT?a:e,-1)+1):n.chatHistory.filter(e=>e.user!==M.SYSTEM)).length?" disabled":""),onMouseDown:()=>{m(!0);let e=(n.chatHistory.some(e=>e.user===M.SYSTEM&&e.content===S.PLACEMENT)?n.chatHistory.slice(n.chatHistory.reduceRight((e,t,a)=>-1===e&&t.user===M.SYSTEM&&t.content===S.PLACEMENT?a:e,-1)+1):n.chatHistory.filter(e=>e.user!==M.SYSTEM)).map(e=>e.content).join(". ");console.log(e),r===O.NEBULA&&(async()=>{let t=i===g.MINECRAFT?"/api/nebula_minecraft":"/api/nebula_cocobots";await (0,eN.L)(s.basePath+t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e}),onmessage:async e=>{if(e.data){let t="";t=!function(e){if("string"!=typeof e)return!1;0===e.indexOf("data:")&&(e=e.split(",")[1]);try{return btoa(atob(e))===e}catch(e){return!1}}(e.data)?e.data:atob(e.data);try{let e=JSON.parse(t);if(m(!1),"WAIT"===e.type)n.addMessage({content:e.content,user:M.SYSTEM}),d(!0);else if("MESSAGE"===e.type){if(console.log(/^(place .*|pick) -?[0-9]+ -?[0-9]+ -?[0-9]+\n?$/gm.test(e.content)),/^(place .*|pick) -?[0-9]+ -?[0-9]+ -?[0-9]+\n?$/gm.test(e.content)){let t=e.content.trim().split("\n"),a=new ed;a.gameLog[0].shapeInPlace=l.objects,t.forEach(e=>{!function(e,t,a){let s=e.trim(),n=t.getLastWorldState();if(s.startsWith("place")){let e=s.split(" ");a===g.MINECRAFT?n?.shapeInPlace.push({pending:!1,breakable:!1,uuid:K.Z(),color:z[e[1].toUpperCase()],position:{x:parseInt(e[2]),y:parseInt(e[3]),z:parseInt(e[4])},shape:j.CUBE}):a===g.COCOBOTS&&n?.shapeInPlace.push({pending:!1,breakable:!1,uuid:K.Z(),color:z[e[2].toUpperCase()],position:{x:parseInt(e[3]),y:parseInt(e[4]),z:parseInt(e[5])},shape:j[e[1].toUpperCase()]})}else if(s.startsWith("pick")){let e=s.split(" "),t={x:parseInt(e[1]),y:parseInt(e[2]),z:parseInt(e[3])};n.shapeInPlace=n.shapeInPlace.filter(e=>e.position.x!==t.x||e.position.y!==t.y||e.position.z!==t.z)}else{let e=s.split(/<(.*)> (.*)/);e[1]&&e[2]&&n?.chatHistory.push({user:M[e[1].toUpperCase()],content:e[2]})}t.addWorldState(n)}(e.trim(),a,i)}),console.log(a),async function(e){for(let t=1;t<e.gameLog.length;t++){let a=e.gameLog[t];l.setObjects(a.shapeInPlace),await new Promise(e=>setTimeout(e,200))}n.addMessage({user:M.SYSTEM,content:S.PLACEMENT})}(a)}else n.addMessage({content:e.content,user:M.NEBULA});d(!1)}}catch(e){console.error("Failed to parse JSON:",e)}}}})})()},children:u?(0,v.jsx)("img",{src:`${s.basePath}/assets/images/loading_colorful.gif`,alt:"loading image"}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("span",{children:"Generate"}),(0,v.jsx)("svg",{version:"1.0",viewBox:"0 0 200 200",children:(0,v.jsxs)("g",{transform:"translate(0,200) scale(0.1,-0.1)",fill:"#000000",stroke:"none",children:[(0,v.jsx)("path",{d:"M1426 1808 c-9 -12 -16 -30 -16 -40 0 -9 -11 -48 -25 -85 -37 -103 -78 -134 -236 -177 -58 -16 -76 -37 -58 -68 5 -9 39 -23 76 -32 38 -10 90 -29 118 -44 59 -32 95 -90 121 -195 27 -110 80 -116 103 -10 18 82 57 159 94 187 27 21 88 44 197 75 28 8 39 44 20 66 -6 7 -27 16 -47 20 -60 11 -141 45 -174 72 -37 32 -63 81 -84 164 -9 35 -21 70 -27 77 -16 19 -45 14 -62 -10z"}),(0,v.jsx)("path",{d:"M791 1451 c-7 -5 -27 -60 -43 -122 -77 -293 -153 -370 -442 -449 -122 -33 -131 -37 -134 -61 -4 -34 10 -43 98 -64 115 -27 229 -71 287 -111 89 -61 152 -180 198 -374 21 -88 30 -102 64 -98 24 3 28 12 61 133 43 157 74 225 130 288 55 62 167 116 319 154 95 23 115 32 124 52 10 20 8 26 -12 42 -13 11 -31 19 -41 19 -34 0 -196 51 -267 84 -130 62 -194 154 -247 358 -40 148 -56 174 -95 149z"})]})})]})}),(0,v.jsx)("button",{className:"realisticButton download",onMouseDown:()=>{let e=new Blob([JSON.stringify(e5[i](o))],{type:"application/json"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="gameLog.json",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t)},children:(0,v.jsx)(ew,{})})]})]})]})]})},eR=()=>{let e=ex().camera;return(0,v.jsx)("div",{id:"cameraSelector",className:"module",children:Object.values(A).map(t=>(0,v.jsx)("button",{className:`${t}${e.camera===t?" selected":""}`,onClick:()=>e.setCamera(t),children:t[0]+t.slice(1).toLowerCase()},t))})};function ev(){return(ev=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e}).apply(null,arguments)}var e_=e=>_.createElement("svg",ev({xmlns:"http://www.w3.org/2000/svg",width:800,height:800,viewBox:"0 0 512 512"},e),T||(T=_.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M149.333 42.667v64h256v256h64v42.666h-64v64h-42.666v-64h-256V42.667zm59.67 232.64-59.67 63.782v23.578h213.334v-11.275l-45.568-45.557-38.773 38.791zm153.664-125.974H149.333V276.65L208 213.96l70.315 70.328 38.799-38.79 45.553 45.554zM288 170.667c17.673 0 32 14.327 32 32s-14.327 32-32 32-32-14.327-32-32 14.327-32 32-32m-181.333-64v42.666h-64v-42.666z"})));function eD(){return(eD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e}).apply(null,arguments)}var eB=e=>_.createElement("svg",eD({xmlns:"http://www.w3.org/2000/svg",width:800,height:800,fill:"none",viewBox:"0 0 24 24"},e),L||(L=_.createElement("path",{stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3v5m0 0h5M3 8l3-2.708A9 9 0 1 1 12 21a9 9 0 0 1-8.777-7"})));(u=w||(w={})).JSON="json",u.JSONL="jsonl",u.CSV="csv",(m=b||(b={})).join="join",m.set_text="set_text",m.set_attribute="set_attribute",m.text_message="text_message",m.command="command",m.target_board_log="target_board_log",m.mouse="mouse",m.user_selection="user_selection",m.working_board_log="working_board_log",m.points="points",m.survey_result="survey_result",m.confirmation_log="confirmation_log",m.leave="leave",(x=R||(R={})).init="init",x.instruction="instruction",x.typing="typing",x.show_progress="show_progress",x.next_state="next_state",x.confirm_next_episode="confirm_next_episode",x.survey="survey",x.submit_survey="submit_survey",x.clear_board="clear_board";let eU=/^<([^>]+)> (.+)$/,eH=(e,t)=>{let a=new ed;a.clear();let s={chatHistory:[],shapeInPlace:[],timestamp:new Date};return e.forEach(e=>{s.shapeInPlace.push({color:z[e.color.toUpperCase()]||z.WHITE,breakable:!1,pending:!1,position:{x:e.position.x,y:e.position.y,z:e.position.z},shape:j[e.shape.toUpperCase()]||j.CUBE,uuid:(0,K.Z)()}),a.addWorldState(structuredClone(s))}),t.push(a),t},ez=(e,t)=>{let a=new ed;return a.clear(),e.worldStates.forEach(e=>{a.addWorldState({chatHistory:e.chatHistory.map(e=>{let t=e.match(eU);return{user:t[1],content:t[2]}}),shapeInPlace:e.blocksInGrid.map(e=>({breakable:!1,pending:!1,color:z[e.color.toUpperCase()]||z.WHITE,position:{x:e.position.x,y:e.position.y,z:e.position.z},shape:j[e.shape.toUpperCase()]||j.CUBE,uuid:(0,K.Z)()})),timestamp:new Date})}),t.push(a),t},eG=/^<([^>]+)> (.+)$/,eF=(e,t)=>{let a=new ed;a.clear();let s={chatHistory:[],shapeInPlace:[],timestamp:new Date};return e.forEach(e=>{s.shapeInPlace.push({color:z[e.colour.toUpperCase()]||z.WHITE,breakable:!1,pending:!1,position:{x:e.x,y:e.y,z:e.z},shape:j.CUBE,uuid:(0,K.Z)()}),a.addWorldState(structuredClone(s))}),t.push(a),t},ek=(e,t)=>{let a=new ed;return a.clear(),e.worldStates.forEach(e=>{a.addWorldState({chatHistory:e.chatHistory.map(e=>{let t=e.match(eG);return{user:t[1],content:t[2]}}),shapeInPlace:e.blocksInGrid.map(e=>({breakable:!1,pending:!1,color:z[e.colour.toUpperCase()]||z.WHITE,position:{x:e.x,y:e.y,z:e.z},shape:j.CUBE,uuid:(0,K.Z)()})),timestamp:new Date})}),t.push(a),t},eW={[g.MINECRAFT]:{[w.CSV]:(e,t)=>{let a;let s=/"(.+?)","?(.*?)"?(?=(\n"|$))/gs;for(;null!==(a=s.exec(e));){let[e,s]=[a[1],a[2]],n=e.split("\n").map(e=>e.trim()),o=new ed;[...n,...s.split("\n").map(e=>e.trim())].forEach(e=>{o.addWorldState(function(e,t){let a=e.trim();if(a.startsWith("place")){let e=a.split(" ");t.shapeInPlace.push({pending:!1,breakable:!1,uuid:(0,K.Z)(),color:z[e[1].toUpperCase()]||z.WHITE,position:{x:parseInt(e[2],10),y:parseInt(e[3],10),z:parseInt(e[4],10)},shape:j.CUBE})}else if(a.startsWith("pick")){let e=a.split(" "),s={x:parseInt(e[1],10),y:parseInt(e[2],10),z:parseInt(e[3],10)},n=t.shapeInPlace.findIndex(e=>e.position.x===s.x&&e.position.y===s.y&&e.position.z===s.z);-1!==n?t.shapeInPlace.splice(n,1):t.chatHistory.push({user:M.SYSTEM,content:`An attempt was made to pick at coordinates [x: ${parseInt(e[1],10)}, y: ${parseInt(e[2],10)}, z: ${parseInt(e[3],10)}]`})}else{let[,e,s]=a.split(/<(.*)> (.*)/)||[];e&&s&&t.chatHistory.push({user:M[e.toUpperCase()]||M.UNKNOWN,content:s})}return t}(e.trim(),o.getLastWorldState()))}),t.push(o)}return t},[w.JSON]:(e,t)=>{let a=JSON.parse(e);return"worldStates"in a?ek(a,t):eF(a,t)}},[g.COCOBOTS]:{[w.JSON]:(e,t)=>{let a=JSON.parse(e);return"worldStates"in a?ez(a,t):eH(a,t)},[w.JSONL]:(e,t)=>{let a=new ed,s={chatHistory:[],shapeInPlace:[],timestamp:new Date};return e.split("\n").filter(e=>/\s/.test(e)).map(e=>JSON.parse(e)).forEach(e=>{switch(e.event){case b.set_text:s.chatHistory.push({user:M.SYSTEM,content:e.data.text}),a.addWorldState(structuredClone(s));break;case b.text_message:if(e.data.html){let t=new DOMParser().parseFromString(e.data.message,"text/html");if(t.body.textContent)switch(t.body.textContent){case"The current working board was updated for your partner":s.shapeInPlace=s.shapeInPlace.map(e=>({...e,pending:!1})),a.addWorldState(structuredClone(s));break;case"Your working board was updated":break;default:s.chatHistory.push({user:M.SYSTEM,content:t.body.textContent}),a.addWorldState(structuredClone(s))}}else s.chatHistory.push({user:`User ${e.user_id}`,content:e.data.message}),a.addWorldState(structuredClone(s));break;case b.command:switch(e.data.command.event){case R.confirm_next_episode:"yes"===e.data.command.answer&&(s.shapeInPlace=[]);break;case R.clear_board:s.shapeInPlace=[],a.addWorldState(structuredClone(s))}break;case b.working_board_log:{let t=Object.values(e.data.objs);console.log(t);let n=a.getLastWorldState();if(t.length>n.shapeInPlace.length){let e=t[t.length-1],a=n.shapeInPlace.map(e=>U(ea[e.shape],e.position)).flat().filter(t=>t.x===e.x&&t.z===e.y);console.log(a),s.shapeInPlace.push({pending:!0,breakable:!1,color:z[e.color[0].toUpperCase()]||z.WHITE,position:{x:e.x,y:a.length?Math.max(...a.map(e=>e.y))+1:1,z:e.y},shape:j[e.type.toUpperCase()]||j.CUBE,uuid:(0,K.Z)()})}else if(t.length<n.shapeInPlace.length){let e=n.shapeInPlace.map(e=>({x:e.position.x,y:e.position.z})).map((e,a)=>t.some(t=>t.x===e.x&&t.y===e.y)?-1:a).filter(e=>-1!==e).pop();void 0!==e&&s.shapeInPlace.splice(e,1)}a.addWorldState(structuredClone(s))}}}),t.push(a),t}}},eV=_.memo(e=>{let{currentIndex:t,currentgameId:a,onClick:s,searched:n}=e;return(0,v.jsxs)("div",{className:`game ${t===a?"selected":""} ${n?"searched":""}`,onClick:s,children:[(0,v.jsx)("div",{className:"new"}),(0,v.jsxs)("span",{children:["Game ",t]})]})});eV.displayName="GameComponent";var e$=()=>{let{environmentMode:{environmentMode:e},chat:t,shapeInPlace:a}=ex(),[s,n]=(0,_.useState)([]),[o,r]=(0,_.useState)(0),[i,l]=(0,_.useState)(0),[c,h]=(0,_.useState)("");(0,_.useEffect)(()=>{n([])},[e]),(0,_.useEffect)(()=>{let e=s[o]?.gameLog.reduce((e,t,a,s)=>t.chatHistory.length!==(s[a-1]?.chatHistory.length??0)?a:e,0);e?l(e):l(0)},[o]),(0,_.useEffect)(()=>{if(s[o]){let e=s[o].getWorldStateById(i);e&&(a.setObjects(e.shapeInPlace),t.setChatHistory(e.chatHistory))}},[o,i]);let p=async a=>{let o=a.target.files&&a.target.files[0];if(o){let r=o.name.split(".").pop()?.toLowerCase(),i=void 0!==r&&Object.values(w).includes(r)?eW[e][r]:void 0;if(i){let e=new FileReader;e.onload=e=>{n([...i(e.target?.result,s)])},e.readAsText(o)}else t.addMessage({user:M.SYSTEM,content:S.WRONG_FILE_EXTENSION});a.target.value=""}};return(0,v.jsxs)("div",{id:"fileManager",className:"module",children:[(0,v.jsx)("label",{htmlFor:"gameFileInput",children:"Upload Game file"}),(0,v.jsx)("input",{id:"gameFileInput",type:"file",onChange:p}),(0,v.jsx)("hr",{}),(0,v.jsx)("div",{id:"games",children:s.map((e,t)=>(0,v.jsx)(eV,{currentIndex:t,currentgameId:o,onClick:()=>{t!==o&&r(t)},searched:""!==c&&e.gameLog.some(e=>e.chatHistory.some(e=>e.content&&e.content.includes(c)))},t))}),s.length>=1&&(0,v.jsx)("input",{type:"text",className:"inputFinder",value:c,onChange:e=>{h(e.target.value)},placeholder:"text to search"}),(0,v.jsx)("hr",{}),(0,v.jsxs)("div",{id:"gameManager",children:[(0,v.jsx)("input",{className:`${s[o]?"":" disabled"}`,type:"range",min:0,step:1,max:s[o]?s[o].getLength()-1:1,value:i,onChange:e=>{l(parseInt(e.target.value))}}),(0,v.jsxs)("div",{className:"buttonWrapper",children:[(0,v.jsx)("div",{className:`realisticButton previousGame${s[o]&&0!==o?"":" disabled"}`,onMouseDown:()=>{r(e=>e-1)}}),(0,v.jsx)("div",{className:`realisticButton previousStep${s[o]&&0!==i?"":" disabled"}`,onMouseDown:()=>{l(e=>e-1)}}),(0,v.jsx)("div",{className:`realisticButton nextStep${s[o]&&i!==s[o].getLength()-1?"":" disabled"}`,onMouseDown:()=>{l(e=>e+1)}}),(0,v.jsx)("div",{className:`realisticButton nextGame${s[o]&&o!==s.length-1?"":" disabled"}`,onMouseDown:()=>{r(e=>e+1)}})]})]})]})},eK=()=>{let{pointer:e}=ex().pointer;return console.log(e),(0,v.jsx)(v.Fragment,{children:e&&(0,v.jsxs)("div",{className:"pointerIndicator",children:[(0,v.jsx)("span",{className:"type",children:e.type}),(0,v.jsxs)("span",{children:["x : ",e.cartesianCoordinate.x]}),(0,v.jsxs)("span",{children:["y : ",e.cartesianCoordinate.y]}),(0,v.jsxs)("span",{children:["z : ",e.cartesianCoordinate.z]})]})})},eY=a(5733),eZ=a.n(eY),eX=()=>{let{environmentMode:{environmentMode:e},shapeInPlace:t,camera:a}=ex(),[s,n]=(0,_.useState)(2),[o,r]=(0,_.useState)("a tower of 3 [color] [shape]"),i=async()=>{let n=[];for(let t=0;t<s;t++)eq[e].forEach(a=>{eQ[e].forEach(e=>{n.push({shape:a,color:e,iteration:t})})});console.log(n);let r=[];for(let e=0;e<n.length;e++){let{shape:s,color:i,iteration:l}=n[e],c=`${o.replace("[color]",i.id.toLowerCase()).replace("[shape]",j[s].toLowerCase())} (${l}).png`;t.setObjects(e=>e.map(e=>({...e,shape:s,color:i}))),a.setCamera(e=>e===A.RANDOM?A.RANDOM2:A.RANDOM),await new Promise(e=>setTimeout(e,400));let h=document.querySelector('canvas[data-engine="three.js r164"]');if(h){let e=h.toDataURL("image/png"),t=document.createElement("img");t.src=e,document.querySelector(".galery")?.appendChild(t),r.push({image:e,filename:c,title:c}),console.log(`Image added for ${s} with color ${i}: ${c}`)}else console.error("Canvas element not found");await new Promise(e=>setTimeout(e,450))}if(r.length>0){let e=new(eZ());r.forEach(t=>{let{image:a,filename:s}=t,n=l(a);e.file(s,n)}),e.generateAsync({type:"blob"}).then(e=>{let t=document.createElement("a");t.href=URL.createObjectURL(e),t.download="images.zip",t.click()})}else console.error("No images to download")},l=e=>{let[t,a]=e.split(","),s=t.match(/:(.*?);/),n=s?s[1]:"",o=atob(a),r=o.length,i=new Uint8Array(new ArrayBuffer(r));for(let e=0;e<r;e++)i[e]=o.charCodeAt(e);return new Blob([i],{type:n})};return(0,v.jsxs)("div",{id:"multimodalSetup",className:"module",children:[(0,v.jsx)("h3",{children:"Multimodal Setup:"}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{htmlFor:"cameraPositions",children:"Number of Camera Positions:"}),(0,v.jsx)("input",{type:"number",id:"cameraPositions",value:s,onChange:e=>{n(parseInt(e.target.value,10))},min:"1",max:"10"})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{htmlFor:"imageTitle",children:"Image Title:"}),(0,v.jsx)("input",{type:"text",id:"imageTitle",value:o,onChange:e=>{r(e.target.value)}})]}),(0,v.jsx)("button",{onClick:i,children:"BOOM"}),(0,v.jsx)("div",{className:"galery",style:{display:"flex",flexWrap:"wrap"}})]})};let eJ={[g.MINECRAFT]:{x:1,y:1,z:1},[g.COCOBOTS]:{x:1,y:.3,z:1}},eQ={[g.MINECRAFT]:[z[y.GREEN],z[y.BLUE],z[y.PURPLE],z[y.RED],z[y.ORANGE],z[y.YELLOW]],[g.COCOBOTS]:[z[y.BLUE],z[y.ORANGE],z[y.RED],z[y.GREEN],z[y.YELLOW],z[y.PURPLE],z[y.BLACK],z[y.WHITE],z[y.BROWN],z[y.MAGENTA]]},eq={[g.MINECRAFT]:[j.CUBE],[g.COCOBOTS]:[j.NUT,j.WASHER,j.SCREW,j.HORIZONTAL_BRIDGE,j.VERTICAL_BRIDGE,j.BOLT,j.GASKET,j.HEX_NUT,j.SQUARE_NUT]},e0={[g.MINECRAFT]:{x:{min:-5,max:5},y:{min:1,max:11},z:{min:-5,max:5}},[g.COCOBOTS]:{x:{min:1,max:16},y:{min:1,max:16},z:{min:1,max:16}}},e1=(e,t)=>e.every(e=>e.x>=t.x.min&&e.x<=t.x.max&&e.y>=t.y.min&&e.y<=t.y.max&&e.z>=t.z.min&&e.z<=t.z.max),e2=(e,t)=>1===e.y||t.some(t=>t.x===e.x&&t.y===e.y-1&&t.z===e.z),e3={[g.MINECRAFT]:(e,t,a)=>{if(!B(t,a)&&e1(t,e0[g.MINECRAFT]))return e},[g.COCOBOTS]:(e,t,a,s)=>{if(!B(t,a)&&e1(t,e0[g.COCOBOTS])&&(s||t.every(e=>e2(e,a))))return e}},e5={[g.MINECRAFT]:e=>({worldStates:e.gameLog.map(e=>({timestamp:e.timestamp,chatHistory:e.chatHistory.map(e=>`<${e.user[0]}${e.user.slice(1).toLowerCase()}> ${e.content}`),blocksInGrid:e.shapeInPlace.map(e=>({x:e.position.x,y:e.position.y,z:e.position.z,type:"wool",colour:e.color.id}))}))}),[g.COCOBOTS]:e=>({worldStates:e.gameLog.map(e=>({timestamp:e.timestamp,chatHistory:e.chatHistory.map(e=>`<${e.user[0]}${e.user.slice(1).toLowerCase()}> ${e.content}`),blocksInGrid:e.shapeInPlace.map(e=>({shape:`${Object.values(j)[e.shape][0]}${Object.values(j)[e.shape].slice(1).toLowerCase()}`,position:{x:e.position.x,y:e.position.y,z:e.position.z},color:`${e.color.id[0]}${e.color.id.slice(1).toLowerCase()}`}))}))})},e6={[g.MINECRAFT]:[O.SIMULATION,O.VISUALIZATION,O.NEBULA],[g.COCOBOTS]:[O.SIMULATION,O.VISUALIZATION,O.NEBULA,O.DIRECT_INSTRUCTIONS,O.MULTIMODAL]},e7={[g.MINECRAFT]:A.FREE,[g.COCOBOTS]:A.FREE},e4={[O.SIMULATION]:f.PLACE,[O.VISUALIZATION]:f.BREAK,[O.NEBULA]:f.BREAK,[O.DIRECT_INSTRUCTIONS]:f.BREAK,[O.MULTIMODAL]:f.PLACE},e8={[O.SIMULATION]:()=>{let{shapeInPlace:e,environmentMode:{environmentMode:t},gameLog:{gameLog:a},clear:s}=ex();return(0,_.useEffect)(()=>{e.pending?document.body.style.cursor="pointer":document.body.style.cursor="auto"},[e]),(0,v.jsxs)("main",{children:[(0,v.jsxs)("div",{id:"mainView",children:[(0,v.jsx)(eR,{}),(0,v.jsx)(eO,{})]}),(0,v.jsxs)(ef,{children:[(0,v.jsx)(eM,{}),(0,v.jsx)(eA,{}),(0,v.jsx)(eS,{}),(0,v.jsx)(eb,{availableUsers:[M.ARCHITECT,M.BUILDER]}),(0,v.jsxs)("div",{id:"gameButtons",children:[(0,v.jsx)("button",{className:"realisticButton",onMouseDown:()=>{let e=new Blob([JSON.stringify(e5[t](a))],{type:"application/json"}),s=URL.createObjectURL(e),n=document.createElement("a");n.href=s,n.download="gameLog.json",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(s)},children:(0,v.jsx)(ew,{})}),(0,v.jsx)("button",{className:"realisticButton",onMouseDown:()=>{let e=document.querySelector('canvas[data-engine="three.js r164"]');if(e){let t=e.toDataURL("image/png"),a=document.createElement("a");a.href=t,a.download="canvas-image.png",document.body.appendChild(a),a.click(),document.body.removeChild(a)}else console.error("Canvas element not found")},children:(0,v.jsx)(e_,{})}),(0,v.jsx)("button",{className:"realisticButton warning",onMouseDown:s,children:(0,v.jsx)(eB,{})})]})]})]})},[O.VISUALIZATION]:()=>(0,v.jsxs)("main",{children:[(0,v.jsxs)("div",{id:"mainView",children:[(0,v.jsx)(eK,{}),(0,v.jsx)(eR,{}),(0,v.jsx)(eO,{})]}),(0,v.jsxs)(ef,{children:[(0,v.jsx)(e$,{}),(0,v.jsx)(eb,{availableUsers:[]})]})]}),[O.NEBULA]:()=>(0,v.jsxs)("main",{children:[(0,v.jsxs)("div",{id:"mainView",children:[(0,v.jsx)(eK,{}),(0,v.jsx)(eR,{}),(0,v.jsx)(eO,{})]}),(0,v.jsx)(ef,{children:(0,v.jsx)(eb,{availableUsers:[M.ARCHITECT]})})]}),[O.DIRECT_INSTRUCTIONS]:()=>(0,v.jsxs)("main",{children:[(0,v.jsxs)("div",{id:"mainView",children:[(0,v.jsx)(eK,{}),(0,v.jsx)(eR,{}),(0,v.jsx)(eO,{})]}),(0,v.jsx)(ef,{children:(0,v.jsx)(eb,{availableUsers:[M.ARCHITECT]})})]}),[O.MULTIMODAL]:()=>{let{shapeInPlace:e}=ex();return(0,_.useEffect)(()=>{e.pending?document.body.style.cursor="pointer":document.body.style.cursor="auto"},[e]),(0,v.jsxs)("main",{children:[(0,v.jsx)("div",{id:"mainView",children:(0,v.jsx)(eO,{})}),(0,v.jsxs)(ef,{children:[(0,v.jsx)(eM,{}),(0,v.jsx)(eX,{})]})]})}},e9=.4,te=new H.Color(11184810);var tt=()=>{let{environmentMode:{environmentMode:e,setEnvironmentMode:t},gameMode:{gameMode:a,setGameMode:s}}=ex(),n=(0,ee.useRouter)();return(0,_.useEffect)(()=>{e6[e].includes(a)?n.push("/"+a.toLowerCase()+"/"+e.toLowerCase()):(s(e6[e][0]),n.push("/"+e6[e][0].toLowerCase()+"/"+e.toLowerCase()))},[e,a]),(0,v.jsxs)("header",{children:[(0,v.jsx)("nav",{id:"modeSelector",children:e6[e].map(e=>{let t=O[e];return(0,v.jsx)("div",{onClick:()=>s(t),className:a===t?"selected":"",children:t},t)})}),(0,v.jsxs)("button",{onClick:()=>{let a=Object.keys(g),s=a.indexOf(e);t(a[(s+1)%a.length])},id:"environmentMode",children:[(0,v.jsx)("img",{src:`${n.basePath}${eT[e]}`,alt:"enviromentModeIcon"}),(0,v.jsx)("span",{children:e})]})]})},ta=()=>{let{gameMode:{gameMode:e}}=ex(),t=e8[e];return(0,v.jsx)(t,{})},ts=e=>{let{initialEnvironmentMode:t,initialGameMode:a}=e;return(0,v.jsxs)(em,{initialEnvironmentMode:t,initialGameMode:a,children:[(0,v.jsx)(tt,{}),(0,v.jsx)(ta,{})]})},tn=!0,to=e=>{let{initialGameMode:t,initialEnvironmentMode:a}=e;return(0,v.jsx)("div",{id:"root",children:(0,v.jsx)(ts,{initialEnvironmentMode:a,initialGameMode:t})})};E&&E instanceof Function&&a.e(131).then(a.bind(a,2131)).then(e=>{let{getCLS:t,getFID:a,getFCP:s,getLCP:n,getTTFB:o}=e;t(E),a(E),s(E),n(E),o(E)})}},function(e){e.O(0,[737,447,567,888,774,179],function(){return e(e.s=1492)}),_N_E=e.O()}]);